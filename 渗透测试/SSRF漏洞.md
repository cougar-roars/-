## SSRF

**简介**
SSRF(Server-Side Request Forgery：服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的
一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。正是因为它是由服务端发
起的，所以它能够请求到与它相连而与外网隔离的内部系统。
**原理**
SSRF形成的原因大都是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与
限制。
通过控制功能中的发起请求的服务来当作跳板攻击内网中其他服务。比如，通过控制前台的请求远程地
址加载的响应，来让请求数据由远程的URL域名修改为请求本地、或者内网的IP地址及服务，来造成对
内网系统的攻击。
**危害**
1、扫描内网开放服务
2、向内部任意主机的任意端口发送payload来攻击内网服务
3、DOS攻击（请求大文件，始终保持连接Keep-Alive Always）
4、攻击内网的web应用，例如直接SQL注入、XSS攻击等
5、利用file、gopher、dict协议读取本地文件、执行命令等

**防御方式**

1、过滤返回的信息，如果web应用是去获取某一种类型的文件。那么在把返回结果展示给用户之前先验证返回的信息是否符合标准。
2、统一错误信息，避免用户可以根据错误信息来判断远程服务器的端口状态。
3、限制请求的端口，比如80,443,8080,8090。
4、禁止不常用的协议，仅仅允许http和https请求。可以防止类似于file:///,gopher://,ftp://等引起的问题。
5、使用DNS缓存或者Host白名单的方式。

**查看是否存在SSRF漏洞**
1、排除法：浏览器F12查看源代码看是否是在本地进行了请求
举例：该资源地址类型为 http://www.xxx.com/a.php?image=（地址）的就可能存在SSRF漏洞。
2、Dnslog等工具进行测试，查看是否被访问
生成一个域名用于伪造请求，看漏洞服务器是否发起 DNS 解析请求，若成功访问在 http://DNSLog.cn
上就会有解析日志。
3、抓包分析发送的请求是不是由服务器的发送的，如果不是客户端发出的请求，则有可能是，接着找
存在HTTP服务的内网地址。
4、访问日志检查：伪造请求到自己控制的公网服务器，然后在服务器上查看访问日志是否有来自漏洞
服务器的请求。
5、扫描工具

**参考**

https://blog.csdn.net/qq_43378996/article/details/124050308
https://www.freebuf.com/vuls/262047.html
https://www.cnblogs.com/miruier/p/13907150.html
## 编辑器漏洞

**介绍**
一般的企业搭建网站有可能是用通用的模板，比如wordpress，emblog，zblog，discuz，dedecms等
等，这些现成的CMS后台如果需要发文章，可能会用到编辑器，比如ewebeditor，fckeditor，
kindeditor，ueditor等等。 这些编辑器是有专门的团队运营开发的。编辑器有可能存在漏洞，只要使
用了该编辑器并且该编辑器的版本存在漏洞，那么网站就会存在相应的漏洞。

**参考**

https://blog.csdn.net/qq_45813980/article/details/126866682
https://blog.csdn.net/qq_43168364/article/details/111605583
https://blog.csdn.net/Guapichen/article/details/110849857
https://www.cnblogs.com/zjhzjhhh/p/15376026.html



## 越权漏洞

**原理介绍**
越权访问（Broken Access Control，简称BAC）是Web应用程序中一种常见的漏洞，由于其存在范围
广、危害大，被OWASP列为Web应用十大安全隐患的第一名。
该漏洞是指应用在检查授权时存在纰漏，使得攻击者在获得低权限用户账户后，利用一些方式绕过权限
检查，访问或者操作其他用户或者更高权限。
越权漏洞的成因主要是因为开发人员在对数据进行增、删、改、查询时对客户端请求的数据过分相信而
遗漏了权限的判定。
在实际的代码审计中，这种漏洞往往很难通过工具进行自动化监测，因此在实际应用中危害很大。其与
未授权访问有一定差别，目前存在着两种越权操作类型，横向越权操作（水平越权）和纵向越权操作
（垂直越权）。

水平越权: 指相同权限下不同的用户可以互相访问
垂直越权: 指使用权限低的用户可以访问到权限较高的用户
水平越权测试方法：主要通过看看能否通过A用户操作影响到B用户
垂直越权测试方法：看看低权限用户是否能越权使用高权限用户的功能，比如普通用户可以使用管理员
的功能

越权漏洞**修复**
1、前后端同时对用户输入信息进行校验，双重验证机制
2、执行关键操作前必须验证用户身份，验证用户是否具备操作数据的权限
3、特别敏感操作可以让用户再次输入密码或其他的验证信息，防范CSRF
4、从用户的加密认证 cookie 中获取当前用户 id，防止攻击者对其修改。或在 session、cookie 中加入
不可预测、不可猜解的 user 信息
5、直接对象引用的资源ID进行加密，防止攻击者枚举ID，敏感数据特殊化处理

**参考**

https://zhuanlan.zhihu.com/p/130919069
https://cloud.tencent.com/developer/article/1516373

## 逻辑漏洞

**概述**
由于程序逻辑输入管控不严，导致程序不能够正常处理或处理错误。一般出现在登录注册、密码找回、
信息查看、交易支付金额等位置，由于逻辑漏洞产生的流量多数为合法流量，一般的防护手段或设备无
法阻止，也导致了逻辑漏洞成为了企业防护中的难题。

**重要性**

常见的OWASP漏洞，通过漏洞扫描工具，大多支持自动化或者半自动化扫描出来，并且传统的安全设备或者防护措施收效甚微
但逻辑漏洞是和系统自身功能和逻辑有关系的漏洞，每一家的漏洞出现可能存在一定的独特性，很难复制或者通过规则脚本和漏扫工具扫描出来，因此逻辑漏洞大多需要配合代码审计和手段测试才可以发现相关漏洞，也是工具无法代替人工的漏洞。

**修复**
1、正确的配置用户的权限信息，不要使用简单的cookie或session
2、对同一手机号进行识别，一定时间内不允许继续发送验证短信请求，也就是所谓的一分钟内不允许
继续请求
3、加入用户身份认证机制或者token验证，防止可被直接通过连接就可访问到用户的功能进行操作
4、删除特权码，不要仅仅对code等返回值进行校验
5、订单类在后端检查订单的每一个值，包括支付状态，MD5 加密、解密、数字签名及验证，有效的避
免数据修改，重放攻击中的各种问题
6、避免使用前端校验，在服务端严格校验用户的数据

**参考**

https://www.cnblogs.com/X-caiji/p/11209963.html
https://zhuanlan.zhihu.com/p/479319687



## 暴力猜解

**简介 **

暴力猜解简单来说就是将密码进行逐个推算，直到找出真正的密码为止。

**C/S架构暴力猜解**

 C/S即客户端/服务器,基于C/S架构的应用程序 如 ssh*
ftp sql-server mysql 等，这些服务往往提供一个高权限的用户，而这个高权限的用户往往可以进行执行命令的操作，如 sql-server 的 sa ，mysql的root，oracle的sys和system帐号，使用这些高权限的用户能在很大程度上给开发人员带来方便，但如果口令被破解带来的危害也是相当大的。

C/S架构主要使用的破解工具Hydra、Bruter、X-scan

**B/S架构暴力猜解**

 一般是对web应用程序中的高权限用户进行猜解，如网站的内容管理系统账户。一般针对 B/S的暴力猜解，使用Burp Suit 镜像表单爆破解

API接口暴力猜解参考  [https://xz.aliyun.com/t/6330](https://links.jianshu.com/go?to=https%3A%2F%2Fxz.aliyun.com%2Ft%2F6330)

**防范**

1、设计安全的验证码（安全的流程+复杂而又可用的图形）
2、在前端生成验证码且后端能校验验证码的情况下，对验证码有效期和次数进行限制。
3、对认证错误的提交进行计数并给出限制，如连续5次密码错误，锁定1小时，验证码用完后立即销毁。
4、必要的情况下，使用双因子认证（手机验证码、滑动验证码等），利用token防止暴力破解。

**参考**

https://www.freebuf.com/articles/network/179289.html
https://www.cnblogs.com/Jewel591/p/7484516.html



## 验证码安全

在安全领域，验证码主要分为两大类：操作验证码和身份验证码。
验证码的主要作用：防止恶意暴力破解、防止恶意注册、刷票、论坛灌水等一切脚本行为。

验证码的种类：手机短信、手机语音、通用文字、加减法、非通用文字、无感知、滑动拼图、文字点选、图标点选、
推理拼图、短信上行、语序点选、空间推理、语音验证


**参考**

https://www.freebuf.com/articles/web/304212.html#:~:text=%E5%B8%B8%E8%A7%84%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98%201%201.%E7%AE%80%E5%8D%95%E7%9A%84%E5%9B%BE%E6%96%87%E8%AF%86%E5%88%AB%202%202.%E9%AA%8C%E8%AF%81%E7%A0%81%E7%A9%BA%E5%80%BC%E7%BB%95%E8%BF%87%203%203.%E5%89%8D%E7%AB%AF%E6%A0%A1%E9%AA%8C%2B%E6%97%A0%E6%95%88%E6%A0%A1%E9%AA%8C%204,6%206.%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4%207%207.%E9%AA%8C%E8%AF%81%E7%A0%81%E5%A4%8D%E7%94%A8%208%208.%E7%8A%B6%E6%80%81%E7%A0%81%E7%BB%95%E8%BF%87%20More%20items